language: python
env:
  global:
  - 'FTP_USER=[FTP_USER]'
  - 'FTP_PASSWORD=[FTP_PASSWORD]'
  - 'FTP_HOST=[FTP_HOST]'
  - 'FTP_PORT=[FTP_PORT]'

branches:
  only: ["master"]

before_install:
  - sudo apt-get update && sudo apt-get install pandoc

script: 
  - make html
  - echo "Done building HTML files"

after_success:
  - echo "Uploading files to `thainlp.org/pythainlp/tutorials`"
  - cd ./build/html
  - find . -type f -name "*" -print -exec curl --ftp-create-dir --verbose --progress-bar --ipv4 --connect-timeout 8  --max-time 120 --retry 128 --ftp-ssl --disable-epsv --ftp-pasv -T {} ftp://${FTP_HOST}:${FTP_PORT}/public_html/pythainlp/tutorials/{} --user ${FTP_USER}:${FTP_PASSWORD} \;
  - echo "Done uploading"
  - rm -rf ./build/html
